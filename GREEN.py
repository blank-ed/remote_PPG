# First ROI is the forehead bounding box
# second roi is a single pixel in the forehead ROI
# third ROI is beside head i guess
# ROI IV is the whole frame scaled down by like 5% on each side (DONE)

# 3 signals:
#   - PVraw(t) no processing other than spatial averaging over ROI (DONE)
#   - PVAC(t) the mean over time of PVraw(t) is subtracted (= PVraw(t) minus DC) (DONE)
#   - PVBP(t) band-pass filtered PVraw(t) signal. For the band-pass (BP) filter Butterworth coefficients (4th order) were used in a phase (DONE)
# neutral (forward and reverse) digital filter (“filtfilt” in Matlab®). Cut-off frequencies for the
# BP filter will be listed in the results section ( 0.8 - 6.0 and 0.8 - 2.0 ) (DONE)

# Fast Fourier transforms (“FFT“ in Matlab®) on PV(t) signals were performed to
# determine the power and phase spectra for PV(t). Zero padding of PV(t) prior to the Fourier
# transform was used to allow for a finer discretization of the frequency

# from remote_PPG.utils import *
#
# input_video = r'C:\Users\ilyas\Desktop\VHR\Datasets\Distance vs Light Dataset\test_all_riccardo_distances_L00_NoEx\D04.mp4'
import numpy as np
from remote_PPG.filters import *

# PV_raw = extract_raw_sig(input_video,framework='GREEN')
PV_raw = [93.2096406882591, 107.66347270183377, 114.88840721005, 119.53665679328411, 120.37336270540604, 119.90658490116694, 119.75619939271255, 120.49813199571327, 120.57224190283401, 120.66760314955941, 120.71896954632055, 120.76641759942844, 120.80987288640152, 120.81042733388902, 120.85886148487735, 120.88408326387234, 120.9006943617528, 120.9236834663015, 120.92664175994284, 120.95638470469159, 120.98298702071922, 120.98925711478923, 120.98221674803524, 120.94583159680876, 120.94746517027863, 120.92052051083591, 120.92405929983329, 120.97972359490355, 121.09639571921886, 121.12249568349607, 121.1463257620862, 121.1681278280543, 121.13006817099308, 121.15656629554655, 121.16758454393903, 121.16408296618242, 121.12413669921409, 121.08854786854012, 121.08978700285782, 121.11436874851155, 121.14661600976423, 121.14868495475113, 121.08021627173136, 121.03553301381281, 121.03702890569183, 121.02555668016194, 121.0364149202191, 121.01964381400333, 121.1645592700643, 121.19544087878066, 121.24904739223624, 121.29076119314122, 121.27194346868302, 121.28587535722791, 121.30321951655155, 121.27229697547034, 121.30675830554894, 121.33869671350321, 121.39810445939509, 121.43498079899976, 121.39621040723982, 121.45514929149797, 121.47977196951655, 121.45880715646582, 121.4403354965468, 121.49072695879971, 121.49290381638485, 121.44173836032388, 121.41339083710407, 121.41299267682781, 121.39747558942605, 121.39491545606096, 121.39850261967135, 121.40783519885687, 121.43207087997142, 121.42710317932841, 121.4470149142653, 121.46425116099071, 121.4486931412241, 121.44433570492974, 121.48749702310073, 121.47983522862586, 121.51292718504405, 121.56650392950702, 121.58938140033341, 121.62019974994045, 121.62099607049296, 121.53471808763992, 121.42527610740652, 121.36928807454156, 121.35021359252202, 121.36283564539175, 121.36994299237914, 121.43282998928316, 121.44507248749701, 121.47456611693259, 121.48581135389378, 121.484375, 121.47312976303881, 121.46400928792569, 121.45925369135507, 121.45822666110979, 121.46217477375565, 121.46933049535603, 121.49918879495118, 121.46534145034532, 121.46180266134793, 121.50961538461539, 121.54574005715646, 121.55354697547034, 121.58423136461062, 121.63653920576327, 121.61816429507024, 121.59362348178138, 121.5586039830912, 121.54093980709692, 121.52472686949274, 121.51913402000476, 121.51925309597523, 121.52752143367468, 121.45469531436056, 121.50229221243153, 121.57082787568469, 121.6178293939033, 121.60941965348893, 121.64653786615861, 121.66959767206477, 121.63405349487972, 121.61037226125268, 121.60134853536556, 121.5630358418671, 121.59603104905929, 121.7021947189807, 121.73631742676828, 121.80205852583948, 121.84556962967373, 121.8763842581567, 121.91320478090022, 121.9138596987378, 121.88965750773994, 121.86494924386758, 121.84882189211717, 121.7723379078352, 121.76629480233389, 121.73136833174564, 121.68825910931173, 121.68855307811383, 121.70566280662062, 121.73386520600143, 121.78066950464395, 121.77076015122648, 121.77427289235531, 121.82079438556799, 121.82114417123124, 121.85975455465586, 121.89152923315075, 121.86986112764943, 121.84348580019052, 121.8398056084782, 121.80910261371754, 121.80468191831388, 121.8071713503215, 121.79205986544414, 121.80187991188377, 121.80536660514407, 121.80184642176708, 121.81088875327458, 121.76070567397, 121.69704468325791, 121.682822547035, 121.69071505120266, 121.67348252560133, 121.68849726125268, 121.71610055965705, 121.72496427720885, 121.73780215527506, 121.75838369254583, 121.7293403191236, 121.71753691355084, 121.718846749226, 121.58752083829482, 121.61774380804953, 121.6725410812098, 121.6931523874732, 121.71950166706358, 121.70562187425577, 121.69449943438913, 121.73164369492736, 121.86696237199332, 121.91390063110263, 121.92849487973326, 121.94107972136223, 121.88506191950464, 121.84943959871397, 121.84462446415813, 121.85223788402, 121.83920278637771, 121.8966197308883, 121.92709945820432, 121.85345841271732, 121.83121725410811, 121.84334811859966, 121.77433243034055, 121.73196743272207, 121.6973237675637, 121.71191801619433, 121.67813393069778, 121.67140985949035, 121.68559106334841, 121.68996710526315, 121.70598282329125, 121.703173374613, 121.76632085020242, 121.79826297928078, 121.85855635270302, 121.85658415694212, 121.8840758216242, 121.81991620028577, 121.6959060192903, 121.64201670040485, 121.59639199809477, 121.57097299952369, 121.60369656465825, 121.62010672183852, 121.65124880924029, 121.64783653846153, 121.6499613003096, 121.68804328411527, 121.65050458442487, 121.68051172898309, 121.63758856275304, 121.6336516134794, 121.6141640866873, 121.61603209097403, 121.60586597999523, 121.61365801381281, 121.6138403488926, 121.64454334365324, 121.74074184329602, 121.77625625148845, 121.71397207668493, 121.74653563348416, 121.84625059537984, 121.8646701595618, 121.86212491069301, 121.86756147296975, 121.8692322576804, 121.86665351869492, 121.8676656644439, 121.88176500357227, 121.87904858299595, 121.89584945820432, 121.82043715765658, 121.78725961538461, 121.78360919266491, 121.79400229221243, 121.77559017027863, 121.83158936651583, 121.86081879614193, 121.91640866873064, 121.95958859252202, 121.96851184805905, 121.96217849487972, 121.95776524172422, 121.9517407418433, 121.9671685222672, 121.96426232436293, 121.97481915336985, 121.98474339128363, 122.00257501786139, 122.00900139914265, 122.02135180995475, 122.0584253691355, 122.09592685758514, 122.0912717313646, 122.11341986187188, 122.1224249821386, 122.12975187544653, 122.13959052750654, 122.13311577161228, 122.11716331269349, 122.14735651345558, 122.19188348416289, 122.1977628602048, 122.26063497261252, 122.25907954274827, 122.24097627411288, 122.24450762086211, 122.23388009049773, 122.22624062276732, 122.22764720766848, 122.24660633484163, 122.2112705406049, 122.18035916289593, 122.1602241605144, 122.12712848297213, 122.11987601214574, 122.12194495713264, 122.1434604965468, 122.17038655036913, 122.06753468087639, 122.11490086925458, 122.13848163253155, 122.11461434270063, 122.08870415575136, 122.07137488092403, 122.05902447011192, 122.04769736842105, 122.04630194689211, 121.75947398190044, 121.71256921290784, 121.73517504167658, 121.75421231245534, 121.72637830435818, 121.77040292331507, 121.73625788878304, 121.72241902834007, 121.69607719099785, 121.62996025839485, 121.58885672183852, 121.5801455703739, 121.58177914384376, 121.59876607525601, 121.62197100500119, 121.60515152417241, 121.5838257620862, 121.6017653012622, 121.65627604786853, 121.67289830912121, 121.69518784234342, 121.70641819480828, 121.67661943319838, 121.58656078828292, 121.55137756013336, 121.52766655751368, 121.50997261252678, 121.53171514050965, 121.569733865206, 121.64743837818527, 121.67698782448201, 121.70247752441057, 121.7274983627054, 121.68422168968802, 121.6494552274351, 121.6160544177185, 121.6039644855918, 121.59195269707072, 121.60659159919028, 121.63740250654918, 121.66817248154322, 121.76267786973088, 121.77447011193141, 121.75381043105502, 121.750096749226, 121.75426440819243, 121.73252560133365, 121.70962580376279, 121.7086322636342, 121.72535499523696, 121.74282195165515, 121.6482012086211, 121.66682915575136, 121.67104146820671, 121.69141090140509, 121.69058853298404, 121.71340646582519, 121.68429983329364, 121.70150258990235, 121.67449467135032, 121.66364387354132, 121.66057394617766, 121.63941935579899, 121.60074571326506, 121.56726303881877, 121.54271478328172, 121.53702146344368, 121.5196326506311, 121.50816786734937, 121.56206834960705, 121.57519647535128, 121.62118956894498, 121.65871338413908, 121.74108418671112, 121.85336910573946, 121.89012264824957, 121.92589009287926, 121.93125595379851, 121.90832638723505, 121.88836255656108, 121.86832430340557, 121.84502634555847, 121.85254301619433, 121.8547310371517, 121.84696877232675, 121.83787434508216, 121.81711419385567, 121.81775422719694, 121.86030528101928, 121.83964932126696, 121.82989253393664, 121.84797719695165, 121.83354295665634, 121.83726780185758, 121.85013917004048, 121.86039830912121, 121.85395332221957, 121.87878810431054, 121.8962141283639, 121.8773777982853, 121.87927557156465, 121.89073291259824, 121.85837401762323, 121.81414845796618, 121.79306829006906, 121.7629532329126, 121.77026896284829, 121.7509749345082, 121.76201550964515, 121.79265152417241, 121.83973118599665, 121.77050339366515, 121.84047541081209, 121.83980188735413, 121.77740607882829, 121.77193230531078, 121.75491932603, 121.75125029768992, 121.71797600619195, 121.73625416765896, 121.73194510597762, 121.76118569897594, 121.75148472850678, 121.77143367468445, 121.78246680757323, 121.77233046558705, 121.78154024767801, 121.794608835437, 121.76429655870444, 121.75629986306262, 121.77384124196237, 121.76821862348177, 121.77544504643963, 121.75130611455108, 121.76856096689687, 121.79770108954513, 121.79677825077398, 121.78942903072159, 121.67813765182186, 121.64234788044772, 121.61491947487497, 121.61483016789711, 121.59137592283876, 121.63528146582519, 121.66969814241486, 121.71345111931412, 121.74096138961657, 121.76697948916409, 121.77960154203382, 121.74841480114313, 121.7430749880924, 121.74047764348654, 121.72628899738032, 121.7190253631817, 121.7415418849726, 121.76504450464395, 121.74775988330555, 121.76358210288163, 121.76769766611098, 121.76809582638722, 121.81842402953083, 121.82055623362704, 121.82809523100738, 121.81703232912598, 121.69995832341033, 121.64074407597046, 121.60185832936413, 121.57754078351988, 121.6176656644439, 121.69540738866397, 121.71503259704691, 121.77951967730412, 121.80540009526077, 121.77292584543939, 121.77580599547511, 121.75239640390569, 121.72077801262205, 121.732012086211, 121.73724770778756, 121.76539429030721, 121.76636550369135, 121.77231185996665, 121.76842328530601, 121.75014884496308, 121.76954706477733, 121.75756876637294, 121.75846927839962, 121.78137651821862, 121.78197189807096, 121.76840467968563, 121.79931233627053, 121.82283728268635, 121.80961240771612, 121.79070537628006, 121.82171722433912, 121.83878602048107, 121.8429983329364, 121.84591197308883, 121.8691987675637, 121.92283132888782, 121.96970632888782, 121.96895838294832, 121.99339128363896, 122.01948380566802, 121.97910216718266, 121.94586508692545, 121.9392600916885, 121.92742691712311, 121.90838220409621, 121.93990012502977, 121.97506102643486, 121.9806427125506, 121.97851795070254, 122.01530126220528, 122.03245936532507, 122.04838205525125, 122.04679685639438, 122.06015197070731, 121.97248600857347, 121.92458397832817, 121.888358835437, 121.88115101809954, 121.87496278875922, 121.85853402595856, 121.85249092045724, 121.87494418313884, 121.88586940342938, 121.86619209930936, 121.881124970231, 121.89565968087639, 121.90827429149797, 121.75439464753512, 121.82019156346749, 121.85597389259347, 121.84836791497975, 121.83826506311026, 121.87981513455584, 121.85044802333888, 121.84856513455584, 121.85820656703977, 121.84844977970945, 121.85339887473208, 121.86275750178613, 121.86139184924981, 121.90744075970468, 121.91324571326506, 121.92033817575613, 121.9182729518933, 121.89402610740652, 121.87432275541795, 121.859568498452, 121.87018858656823, 121.85596645034532, 121.88105426887354, 121.90216792688734, 121.87727360681114, 121.90208234103358, 121.93012473207907, 121.8669363241248, 121.76751533103119, 121.73341122886401, 121.7048032269588, 121.74217075494165, 121.80361395570374, 121.8248318051917, 121.85330956775422, 121.88012026673017, 121.87948395451298, 121.8359281971898, 121.7583092700643, 121.72403399618956, 121.69975366158609, 121.69879361157417, 121.68828515718027, 121.67168894379614, 121.6683697011193, 121.65684165872827, 121.63940447130268, 121.62477301143129, 121.61487482138604, 121.6096689688021, 121.59770555489402, 121.60346957608954, 121.62398413312692, 121.81278280542986, 121.8229117051679, 121.82224190283401, 121.8666423553227, 121.87710987735174, 121.91142608359132, 121.86784427839962, 121.67992751250297, 121.75572308883066, 121.82144186115741, 121.90667420814479, 121.91539280185758, 121.91586538461539, 121.9364245951417, 121.95491113955703, 121.92932469040247, 121.93202994760657, 121.92246665872827, 121.99047020123838, 122.0130164920219, 122.05196177661348, 122.06875148844962, 122.09229131936175, 122.10567992379137, 121.9892310669207, 121.93429983329364, 121.92328158490116, 121.92152521433674, 121.90190000595379, 121.88336880804953, 121.90288610383425, 121.92021165753751, 121.94233374017622, 121.97864819004525, 121.96178405572755, 121.98226884377232, 121.96642801857584, 121.95388410931173, 121.96722806025244, 122.03574139676113, 122.09702086806382, 122.12040069064062, 122.14359445701356, 122.18239833889021, 122.1824653191236, 122.16437693498452, 122.16952697070731, 122.15612720290545, 122.156395123839, 122.14180831745654, 122.08410856751607, 122.0776189271255, 122.0853402595856, 122.1012108537747, 122.09639944034294, 122.13152313050726, 122.14843936056204, 122.17001443796141, 122.16787479161705, 122.21554239104549, 122.24731334841628, 122.22543313884258, 122.25172288044772, 122.2455346511074, 122.1172116873065, 121.83585005358418, 121.82499181352702, 121.71755551917123, 121.77352122529173, 121.78757591093117, 121.807967670874, 121.84932796499166, 121.85397564896404, 121.87572189807096, 121.89429774946416, 121.93201878423433, 121.93037404739223, 121.94933689568944, 121.90661467015956, 121.81925756132412, 121.80180176827815, 121.78773219814241, 121.7469375148845, 121.77565715051202, 121.85035871636103, 121.85827354727316, 121.85134481424149, 121.8904277804239, 121.90805102405334, 121.92246293760418, 121.90788357346987, 121.87485487616098, 121.88891700404858, 121.89227717909026, 121.9141350619195, 121.93724324243867, 121.95856900452488, 121.95052021314598, 121.99038089426054, 122.04254361157417, 122.04982957251727, 122.08324898785425, 122.10211136580138, 122.10880938914026, 122.1396463443677, 122.10522594665396, 122.0845588235294, 122.10582876875446, 122.0232160931174, 121.94366218147178, 121.92472910216718, 121.87959930935936, 121.87851274112883, 121.85730977613717, 121.85890985949035, 121.88321252083828, 121.8745757918552, 121.89749419504643, 121.8818096570612, 122.03216539652298, 122.07741798642533, 122.07496948678256, 122.10055221481305, 122.119068528221, 122.0407165396523, 121.99985859728507, 121.94125089306978, 121.65383499047392, 121.76559523100738, 121.8794467432722, 121.90217909025958, 121.95660052988806, 121.98071713503215, 121.98219814241486, 121.97198365682304, 121.97061800428673, 122.042342670874, 122.05323812217195, 122.04935698975946, 122.0584253691355, 122.03279054536794, 122.01943543105502, 122.01115220885924, 122.01834142057632, 122.02754376041915, 122.03408921767087, 122.03381385448915, 122.0124136699214, 122.04203753869969, 122.05914726720647, 122.07889899380804, 122.04211940342938, 122.05650154798761, 122.04598565134556, 122.09482168373422, 122.1331455406049, 122.16749895808525, 122.17126101452726, 122.16538163848534, 122.1291230054775, 122.13823975946653, 122.10465661467016, 122.0674044415337, 122.0666043998571, 122.06658579423672, 122.07152000476303, 122.06599041438437, 122.05856305072636, 122.04802110621576, 122.0302713443677, 122.00419370683495, 121.98388381162181, 121.9874039949988, 121.98847195760895, 121.96585496546797, 121.99036228864014, 121.96925607287449, 121.96018025125029, 121.95903414503452, 121.96237199333174, 121.97906867706597, 122.00197591688497, 122.03432364848773, 122.03324824362943, 122.01960660276256, 121.9885128899738, 121.96601869492736, 121.86033877113599, 121.8989826446773, 121.92871814717789, 121.94668373422243, 121.95896716480114, 121.95381340795427, 121.95361618837818, 121.94760657299356, 121.89887101095499, 121.91137398785425, 121.89467730412002, 121.89975291736127, 121.87054209335555, 121.86811964158133, 121.85319421290784, 121.85453753869969, 121.84637711359846, 121.8527253512741, 121.90842313646105, 121.94365473922362, 121.97342745296498, 121.99176515241724, 121.98001012145748, 121.96085749583234, 121.92533564539175, 121.91944138485353, 121.93283371040724, 121.9235829959514, 121.90080599547511, 121.89708487139795, 121.90871338413908, 121.88983612169564, 121.91326431888544, 121.9082519647535, 121.92929864253394, 121.91067813765181, 121.93629807692307, 121.9836084484401, 122.0474443319838, 122.08438765182186, 122.11273517504168, 122.11023085853775, 122.24776360442962, 122.25696222314836, 122.28336359847582, 122.32389036080019, 122.34450538818766, 122.19990994879733, 122.14814167063587, 122.11894573112646, 122.11110904381995, 122.09932052274351, 122.12763455584663, 122.16575002976899, 122.18372678018575, 122.2315729935699, 122.24993674089069, 122.28040902595856, 122.31074735055965, 122.3058689568945, 122.22586106811146, 122.27152670278637, 122.29134540962133, 122.3015822219576, 122.29898487735174, 122.29011371755179, 122.28664562991187, 122.28234028935461, 122.23195999047392, 122.21336553346035, 122.07358522862586, 122.02812797689926, 121.95850574541556, 121.91070790664443, 121.90894037270779, 121.92535052988806, 121.95348967015956, 121.92036050250059, 121.91589515360799, 121.94729027744701, 121.92347508335318, 121.96748853893784, 122.03385850797808, 122.06430102405334, 122.10146389021195, 122.14036824243867, 122.15060133365087, 122.16756965944272, 122.18001681948083, 122.18074243867586, 122.22465914503452, 122.20626562872111, 122.14381028221004, 122.093943498452, 122.09093310907359, 122.06627694093831, 122.03221749226006, 122.0206261907597, 121.99206284234342, 121.98862080257204, 121.94839545129793, 121.94910246487258, 121.95115652536317, 121.96698618718742, 121.94286586091926, 121.95468415098833, 121.98651464634436, 121.96741039533222, 121.99007204096213, 121.99106558109074, 121.96251339604667, 122.00128378780661, 121.96879093236484, 121.99082370802572, 121.99707519647535, 122.01166572398189, 122.00365042271969, 122.03053554417718, 122.04632799476066, 122.01366024648725, 122.00985353655632, 122.0094330495356, 121.98089947011192, 121.95207192188616, 121.94079319480828, 121.92862139795189, 121.92744180161942, 121.92781391402714, 121.93188482376756, 121.95282731007383, 121.97671320552512, 121.98473594903548, 122.01690506668254, 122.04670382829245, 122.0496770064301, 122.03853596094308, 122.05004539771373, 122.07506995713264, 122.2490548344844, 122.31573365682304, 122.34443096570611, 122.34955867468445, 122.31928733031674, 122.3261044296261, 122.31656718861633, 122.30800860323886, 122.29272222552989, 122.27938199571327, 122.26610874613003, 122.26849770778756, 122.27662464277208, 122.28128721124077, 122.27893173969993, 122.27387845320314, 122.22944078947368, 122.22541453322219, 122.19495341152655, 122.23450896046677, 122.24433644915456, 122.25580495356037, 122.26558778875922, 122.25280572755418, 122.27697070731126, 122.25887488092403, 122.26403980114313, 122.254822576804, 122.25720409621339, 122.25116099071207, 122.27771121100261, 122.26749672541081, 122.29013232317217, 122.26923821147892, 122.24295591212193, 122.21988494284354, 122.18851958799713, 122.17012979280781, 122.17510493569897, 122.17570031555131, 122.19494969040247, 122.1941310431055, 122.0999903250774, 122.15083204334366, 122.19414592760181, 122.19371427720885, 122.21561309240295, 122.25369507620861, 122.28362407716122, 122.2564338235294, 122.21422883424624, 122.1829713919981, 122.1566407180281, 122.169560460824, 122.1516879018814, 122.11197978685401, 122.1051887354132, 122.07275541795666, 122.07972880447726, 122.09519751726602, 122.10636461062157, 122.15837848297213, 122.15204885091688, 122.15297541081209, 122.16269870802572, 122.17818230531078, 122.15636163372231, 122.15092507144558, 122.1297072219576, 122.1173233210288, 122.1034286437247, 122.0763016492022, 122.0694398964039, 122.06060594784472, 122.04097329721361, 122.00939211717075, 121.9829572517266, 121.96566518814002, 121.94572368421052, 121.9710459335556, 122.02836240771612, 122.05473773517504, 122.09249226006192, 122.13067099309359, 122.1279471302691, 122.15534948797333, 122.17181174089069, 122.17487422600618, 122.11239655275065, 122.1104504048583, 122.12116352107644, 122.12089932126696, 122.13845186353893, 122.16712312455346, 122.21387160633483, 122.28475157775661, 122.27298166230054, 122.26423329959513, 122.26245460228625, 122.26183689568944, 122.23003244820195, 122.2410879078352, 122.06182647654202, 122.10023219814241, 122.12809225410811, 122.15236886758751, 122.15014363538937, 122.15490667420814, 122.16161958204334, 122.19665396522981, 122.22490473922362, 122.22463309716599, 122.24102836984996, 122.24438110264349, 122.26530870445343, 122.24508811621814, 122.27642370207192, 122.26940194093831, 122.26051217551797, 122.26790977018337, 122.2420479578471, 122.25882278518695, 122.26382397594665, 122.27700047630388, 122.2833673195999, 122.30301113360323, 122.26372722672065, 122.2540709097404, 122.27719769587996, 122.23222419028339, 122.20365712074303, 122.2162717313646, 122.20195656703977, 122.17020049416527, 122.1975209871398, 122.21062306501547, 122.18923032269588, 122.18836702190997, 122.2143181412241, 122.22208040604906, 122.24154932722077, 122.24322755417957, 122.2149544534413, 122.21053003691355, 122.21425860323886, 122.19675443557989, 122.17522401166944, 122.15622395213146, 122.12150214336747, 122.11966762919742, 122.10700836508693, 122.10457102881638, 122.10829587401761, 122.09933540723982, 122.10545293522267, 122.10109922005239, 122.09478819361752, 122.09453515718027, 122.08600261967135, 121.97761371755179, 121.91724220052393, 121.88388976542034, 121.68253974160514, 121.68254346272921, 121.72256415217909, 121.75654545725172, 121.74200330435818, 121.77124389735651, 121.78964485591807, 121.76533475232198, 121.77083085258394, 121.86276122291021, 121.86370266730174, 121.8627128482972, 121.87169564181947, 121.88732064181947, 121.92339321862347, 121.90324705286973, 121.91580956775422, 121.8873169206954, 121.93769721957608, 121.93359654084306, 121.95060579899976, 121.9904181055013, 122.008391134794, 122.01904843415099, 122.04633915813288, 122.06361633722314, 122.09002515479875, 122.09527938199571, 122.07170978209096, 122.07824035484639, 122.07997439866635, 122.07051158013812, 122.071133007859, 122.07514065849011, 122.07792033817576, 122.08753200166706, 122.10284814836865, 122.09585615622767, 122.09787672660157, 122.15366381876638, 122.1676887354132, 122.2327451476542, 122.2944302214813, 122.3093556501548, 122.32265122648249, 122.34194525482258, 122.33643799118838, 122.26553569302214, 122.21658802691117, 122.18328396642057, 122.19046945701356, 122.16957534532031, 122.17610591807573, 122.18722835794236, 122.22438378185282, 122.23007710169088, 122.21268084663015, 122.20685356632531, 122.18821445582282, 122.1426120802572, 122.05220737080256, 122.09436398547273, 122.13645734103358, 122.16000089306978, 122.1558592819719, 122.18486544415336, 122.18064196832579, 122.19386312217195, 122.20101140152417, 122.22389259347463, 122.19356543224576, 122.18827399380804, 122.17504911883782, 122.15975529888068, 122.14467358299595, 122.13332787568469, 122.12529768992617, 122.11129882114788, 122.10818796141938, 122.1124709752322, 122.10569480828768, 122.10359981543225, 122.07946460466778, 122.04406927244581, 122.04397252321981, 122.02644974994045, 122.00912047511312, 122.05916959395094, 122.07979206358657, 122.10296722433912, 122.09322160038104, 122.10592551798047, 122.10937127887591, 122.10854518933078, 122.0868249880924, 122.12329200404858, 122.1166423553227, 122.10581016313408, 122.07775660871636, 122.0524790128602, 122.04160960943081, 122.0402253512741, 122.0442516075256, 122.07865339961896, 122.0959156942129, 122.09111916527745, 122.12225753155512, 122.11186443200762, 122.096209663015, 122.0872975708502, 122.0720297987616, 122.06645183376995, 122.05186130626339, 122.05000074422482, 122.05729786854012, 122.05844769587996, 122.06215021433674, 122.05323440104786, 122.0169608835437, 122.02202533341271, 121.8813370743034, 121.94277655394141, 122.1097657180281, 122.17583055489402, 122.21119239699928, 122.2725165217909, 122.32169117647058, 122.33652729816623, 122.33976467611336, 122.34856141343177, 122.3527439568945, 122.35876473565133, 122.33324898785425, 122.32303078113836, 122.31476616456298, 122.29256965944272, 122.3088160871636, 122.30442516075256, 122.32861618837818, 122.33242661943319, 122.35069733865205, 122.37841227077875, 122.37446787925695, 122.34764973803286, 122.2912523815194, 122.28745683496071, 122.26192992379137, 122.3141596213384, 122.37697591688497, 122.42585288163848, 122.43859028935461, 122.45473252560133, 122.43900333412716, 122.35220067277923, 122.3271463443677, 122.32971019885687, 122.31243674089069, 122.29083189449868, 122.28026018099547, 122.27611112764943, 122.26824839247439, 122.26254390926411, 122.26837118956894, 122.29317992379137, 122.26696832579185, 122.25011907597046, 122.25555191712311, 122.21951655155989, 122.1819927363658, 122.19125461419385, 122.21101750416766, 122.2004197427959, 122.2308697011193, 122.21805787092164, 122.16879018814002, 122.182774172422, 122.21517772088592, 122.20967045725172, 122.20302080852584, 122.18404679685639, 122.06831239580852, 122.10313839604667, 122.07822547035008, 122.05307067158847, 122.03381757561324, 122.0267213919981, 122.00080748392475, 122.01650690640628, 121.98153206120504, 122.00101214574899, 121.97263113241247, 121.97747231483686, 121.9645600142891, 121.97066637889974, 121.99520719218862, 121.98238791974279, 121.97594665396522, 121.98402521433674, 121.99926321743271, 122.02493525244105, 122.02495013693736, 122.0466145213146, 122.05711181233626, 122.0429975887116, 122.03274217075494, 122.06274931531317, 122.08752083829482, 122.11294727911407, 122.17664175994284, 122.1950427185044, 122.2076387235056, 122.21943840795427, 122.2611447666111, 122.2734765718028, 122.2373221302691, 122.2435475708502, 122.24132605977613, 122.25018605620386, 122.30518799118838, 122.3266923672303, 122.3397572338652, 122.34317694689211, 122.33460347701833, 122.33164890450107, 122.32389408192427, 122.30587267801857, 122.31946594427244, 122.28755358418671, 122.32860502500596, 122.35584365325077, 122.35752932245772, 122.40146835556084, 122.40169162300548, 122.40381266372945, 122.36764705882352, 122.37808481185996, 122.37543165039294, 122.4077644974994, 122.46582519647535, 122.466483835437, 122.27498362705406, 122.33896091331269, 122.3298329959514, 122.30595454274827, 122.3061443200762, 122.2630983567516, 122.305266134794, 122.31512339247439, 122.31774306382472, 122.33981677185044, 122.35445939509407, 122.3506080316742, 122.31289816027625, 122.27915872826863, 122.29049699333174, 122.29077607763753, 122.27134808883066, 122.26854236127649, 122.22879703500833, 122.23679000952608, 122.22653459156942, 122.23993435937128, 122.2503907180281, 122.24340244701119, 122.25471094308168, 122.2661124672541, 122.27593995594188, 122.25817903072159, 122.21777878661585, 122.22410469754703, 122.21469025363182, 122.19590229816623, 122.1918165039295, 122.06928733031674, 122.03925413788997, 122.04351482495832, 122.04256593831865, 122.09912330316742, 122.10582504763039, 122.12990072040962, 122.16885344724935, 122.18898844963086, 122.16513232317217, 122.16302244582043, 122.12973699095022, 122.15257352941175, 122.14500476303881, 122.16440298285306, 122.18723580019052, 122.19415336984996, 122.1751495891879, 122.17228060252441, 122.17691340200047, 122.20156584901167, 122.18038521076447, 122.18346258037627, 122.16959022981662, 122.16349502857823, 122.19797868540128, 122.2434657061205, 122.17452071921886, 122.12437857227911, 122.03757591093117, 122.00224011669445, 121.99828456180042, 121.99272148130507, 121.98265956180042, 121.99040694212907, 121.99378200166706, 122.00031257442248, 122.02481989759467, 122.01566965348893, 122.08436904620147, 122.2372737556561, 122.27978759823768, 122.31448335913312, 122.33077071921886, 122.37551351512265, 122.38177988806858, 122.39018962848297, 122.40335868659204, 122.38920353060252, 122.38453724100977, 122.36094903548464, 122.33945210169088, 122.33472255298881, 122.37136446177661, 122.34606826030007, 122.3683019766611, 122.3613955703739, 122.36875595379851, 122.4072286556323, 122.41104280781138, 122.38348416289593, 122.27925547749464, 122.27660975827578, 122.25422347582757, 122.27857451178852, 122.32411734936889, 122.32451923076923, 122.31832355918075, 122.31698767563705, 122.29802854846392, 122.25346064539175, 122.25135076804, 122.2026673017385, 122.20419668373422, 122.22051753393664, 122.26689018218623, 122.27597344605859, 122.41674356989759, 122.44553390688259, 122.46141938556799, 122.43947219576089, 122.43237601214574, 122.4083003393665, 122.33937395808525, 122.31621740295309, 122.31550294713027, 122.34319183138842, 122.2997588711598, 122.3311056203858, 122.25695105977613, 122.17660082757799, 122.15970320314361, 122.10532641700405, 122.06264140271493, 122.04908162657775, 122.04575494165277, 122.03619537389854, 121.99748079899976, 121.98701699809477, 122.04594844010478, 122.09331462848297, 122.13898770540604, 122.12580376280066, 122.13144126577757, 122.1460987735175, 122.11125416765896, 122.09917167778042, 122.09150244105739, 122.06976363419861, 122.03421945701356, 122.0105903191236, 121.98991575375089, 121.99691890926411, 121.9912665217909, 121.9776769766611, 122.01110755537032, 122.02592507144558, 122.02476035960943, 122.04316131817099, 122.01646597404144, 122.06849845201238, 122.07685981781376, 122.11295472136223, 122.09766090140509, 122.11776241366992, 122.10824005715646, 122.08996561681353, 122.09796603357943, 122.08409740414383, 122.04779411764706, 122.0209350440581, 122.03148070969279, 122.04953560371517, 122.03397386282448, 122.06616158609192, 122.10528920576327, 122.17186383662776, 122.21333204334366, 122.22735695999047, 122.2951967730412, 122.34380953798524, 122.36675398904501, 122.36763961657537, 122.40511133603239, 122.3397572338652, 122.29831507501785, 122.28176723624672, 122.0980181293165, 122.16847389259347, 122.18493614551083, 122.16430251250297, 122.14435356632531, 122.15815149440343, 122.15876175875208, 122.18407656584901, 122.25595751964752, 122.30186502738746, 122.30155617408906, 122.3227963503215, 122.35384913074542, 122.39068825910931, 122.37944302214812, 122.4083189449869, 122.37605679923792, 122.33288803881877, 122.32367453560371, 122.276572547035, 122.26255507263633, 122.28272356513455, 122.30081194927364, 122.27508409740413, 122.31462476184805, 122.32116649797571, 122.30862630983567, 122.28416736127649, 122.24331314003334, 122.20669727911407, 122.18758930697784, 122.15484713622291, 122.14209856513455, 122.15264050964515, 122.16132561324125, 122.17074749940461, 122.18096198499643, 122.17071028816385, 122.18445984162895, 122.1986596511074, 122.2305124732079, 122.23081388425815, 122.25199824362943, 122.2396366694451, 122.22580897237437, 122.21793135270302, 122.21049654679685, 122.21038491307453, 122.21693781257441, 122.24499136699214, 122.25886743867586, 122.2671878721124, 122.23670814479638, 122.2437596749226, 122.23124553465111, 122.23142042748273, 122.21405766253869, 122.1880209573708, 122.18019543343652, 122.19223699095022, 122.06549922600618, 122.12901881400333, 122.1894535901405, 122.20088116218147, 122.20514929149797, 122.20606840914503, 122.19282492855442, 122.18004658847345, 122.16437693498452, 122.16348758633008, 122.13126637294593, 122.14821237199332, 122.16943766372945, 122.17147683972374, 122.17781763515123, 122.17821951655155, 122.18937172541081, 122.20962952488688, 122.23744492736365, 122.24728357942367, 122.26078381757561, 122.25156659323648, 122.24306754584424, 122.22580525125029, 122.19593206715884, 122.18449705286973, 122.15026643248392, 122.12127515479875, 122.13788997380328, 122.11862199333174, 122.16062604191474, 122.14412285663252, 122.12278965229817, 122.10488732436293, 122.10317932841153, 122.08175309597523, 122.10756281257441, 122.10886148487735, 122.11864804120029, 122.13726110383425, 122.14781421171708, 122.16443275184567, 122.1888693736604, 122.23523457966182, 122.27102435103596, 122.27244209930936, 122.29797273160275, 122.3475790366754, 122.36239655275065, 122.39226601571802, 122.40103298404381, 122.40599324243867, 122.43093221600381, 122.46849324243867, 122.49304149797571, 122.52648324005715, 122.52364402238628, 122.51299416527745, 122.5200717432722, 122.52461151464634, 122.43524499880924, 122.48171439628483, 122.50326342581566, 122.49994046201476, 122.52659859490355, 122.43283371040724, 122.39315908549655, 122.29857183257919, 122.24586955227434, 122.21378602048107, 122.19085273279352, 122.18141224100977, 122.18251741486068, 122.21856394379614, 122.25282061205048, 122.26820373898546, 122.30641596213384, 122.27287002857823, 122.23425592402953, 122.22722672064776, 122.18499568349607, 122.18387190402477, 122.15526390211954, 122.15574764824957, 122.14640018456775, 122.17191593236484, 122.16377039175994, 122.13342090378661, 122.12241009764229, 122.10045174446296, 122.07259913074542, 122.09158802691117, 122.06134645153608, 122.05406049059299, 122.03474785663252, 122.00928792569658, 122.01987452369612, 122.00209499285543, 121.99393456775422, 122.00737526792093, 122.02946013931889, 122.02000104191474, 122.05111708144796, 122.0473140926411, 122.04018814003334, 122.05054774946416, 122.06207951297928, 122.06613553822338, 122.13145615027388, 122.15269260538223, 122.17941399738032, 122.21015420338175, 122.20457251726602, 122.2037910812098, 122.20910856751607, 122.21167242200524, 122.19601021076447, 122.17611708144796, 122.15936830197666, 122.1388983984282, 122.00784412955466, 122.06559225410811, 122.05712669683257, 122.04363390092878, 122.05647550011908, 122.02897639318886, 122.05208085258394, 122.07026598594904, 122.14981989759467, 122.20910856751607, 122.21784576684925, 122.24767057632769, 122.22924729102166, 122.2547407120743, 122.25033862229101, 122.2391640866873, 122.22585734698737, 122.2339656763515, 122.24978417480352, 122.2249903250774, 122.23694257561324, 122.2486790009526, 122.21880581686115, 122.26021820671588, 122.26517846511074, 122.27066340200047, 122.29782016551559, 122.36406361633722, 122.39384749345082, 122.38737273755656, 122.41791944510598, 122.43337327339843, 122.41527744701119, 122.38107287449392, 122.32465319123601, 122.31902313050726, 122.31478104905929, 122.29841554536794, 122.34408862229101, 122.35137086211002, 122.36389988687782, 122.37260359609431, 122.37315432245772, 122.35224532626816, 122.31863613360323, 122.31100782924506, 122.31139854727316, 122.30115057156465, 122.28010389378423, 122.25936979042629, 122.2751882888783, 122.2353015598952, 122.2797987616099, 122.34436398547273, 122.36705540009525, 122.37776479518932, 122.39250044653488, 122.41396389021195, 122.42744180161942, 122.42753482972135, 122.37974443319838, 122.40144974994045, 122.3900854370088, 122.39225113122171, 122.36685818051917, 122.35723163253155, 122.28606885567991, 122.28317382114788, 122.3215907061205, 122.33753944391522, 122.36152208859252, 122.37489952964991, 122.40783519885687, 122.40480248273398, 122.40348520481066, 122.36857733984282, 122.3574362943558, 122.35572085615622, 122.3419080435818, 122.34264482614908, 122.34854280781138, 122.35102107644677, 122.29198172183852, 122.18674089068826, 122.14296186592046, 122.13839604667777, 122.10709767206477, 122.14382516670635, 122.2390673374613, 122.25390718028102, 122.2924096511074, 122.32371174684448, 122.28688378185282, 122.26159874374851, 122.2523294236723, 122.23581135389378, 122.24557186234817, 122.26597850678732, 122.27935222672065, 122.31239208740176, 122.316116932603, 122.3375915396523, 122.3542584543939, 122.38186919504643, 122.4079282269588, 122.43816236008573, 122.44994343891402, 122.39358701476542, 122.34548404381995, 122.3020213145987, 122.27848520481066, 122.2396366694451, 122.24844457013575, 122.27970573350797, 122.29118912241009, 122.31449824362943, 122.32751845677542]

PV_raw = PV_raw[30:]
PV_ac = np.array(PV_raw) - np.mean(PV_raw)
PV_bp = butterworth_bp_filter(PV_raw, fps=30, low=0.8, high=2.0)

from scipy.fft import fft, fftfreq
import matplotlib.pyplot as plt

# Perform the FFT on PV(t)
fft_PV = fft(PV_bp)

# Calculate the power spectrum by taking the absolute square of the FFT
power_spectrum = np.abs(fft_PV)**2

# Calculate the corresponding frequencies
sampling_rate = 30  # Assuming the sampling rate is 1 Hz
freqs = fftfreq(len(PV_bp), d=1/sampling_rate)

# Display only the positive frequencies and corresponding power spectrum
positive_freqs = freqs[:len(freqs)//2]  # Take only the first half
positive_spectrum = power_spectrum[:len(power_spectrum)//2]  # Take only the first half

# Define the frequency range to plot
freq_range = (0, 6.5)  # Frequency range from 0 Hz to 6.5 Hz

# Find the indices corresponding to the desired frequency range
start_idx = np.argmax(positive_freqs >= freq_range[0])
end_idx = np.argmax(positive_freqs >= freq_range[1])

# Extract the frequencies and power spectrum within the desired range
freqs_range = positive_freqs[start_idx:end_idx]
power_spectrum_range = positive_spectrum[start_idx:end_idx]

max_idx = np.argmax(power_spectrum_range)
f_max = freqs_range[max_idx]
hr = f_max * 60.0

print(hr, f_max)

# Plot the power spectrum for the desired frequency range
plt.plot(freqs_range, power_spectrum_range)
plt.xlabel('Frequency (Hz)')
plt.ylabel('Power')
plt.title('Power Spectrum of PV(t) - Positive Frequencies')
plt.show()